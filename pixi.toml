[project]
authors = ["Aadam <aadimator@gmail.com>"]
channels = ["conda-forge"]
name = "JaxARC"
platforms = ["osx-arm64", "linux-64"]
version = "0.1.0"

[tasks]

# Core system dependencies (conda-forge packages)
[dependencies]
python = ">=3.13.5,<3.14"

# Development and analysis tools (not needed for the package itself)
marimo = ">=0.13.6,<0.15"
wandb = ">=0.21.0,<0.22"
cairo = ">=1.18.4,<2"

[pypi-dependencies]
# Install the package itself in editable mode - this will pull all dependencies from pyproject.toml
JaxARC = { path = ".", editable = true }
# JAX ecosystem packages with platform-specific extras
jax = { extras = ["cuda12"] }

[activation.env]
JAX_PLATFORMS = "cuda,cpu"
# XLA_FLAGS = "--xla_gpu_autotune_level=0"
JAX_COMPILATION_CACHE_DIR="/tmp/jax_cache"
LD_LIBRARY_PATH = ""

[target.osx.pypi-dependencies]
jax = { extras = ["cpu"] }

[target.osx.activation.env]
JAX_PLATFORMS = "cpu"

[environments]
default = { solve-group = "default" }
dev = { features = ["dev"], solve-group = "default" }
docs = { features = ["docs"], solve-group = "default" }
test = { features = ["test"], solve-group = "default" }
bench = { features = ["bench"], solve-group = "default" }

[feature.test.dependencies]
pytest = ">=8.4.0,<9"
pytest-cov = ">=6.1.1,<7"
hypothesis = ">=6.100.0,<7"

[feature.test.tasks]
test = "pytest test/"

[feature.dev.dependencies]
pytest = ">=8.4.0,<9"
pytest-cov = ">=6.1.1,<7"
hypothesis = ">=6.100.0,<7"
pre-commit = ">=4.2.0,<5"
pylint = ">=3.3.7,<4"
jupyter = ">=1.1.1,<2"

[feature.dev.tasks]
lint = "pre-commit run --all-files"
pylint = "pylint jaxarc"

[feature.docs.dependencies]
python = ">=3.11,<3.14"
sphinx = ">=7.2.0,<8"
myst-parser = ">=2.0.0,<3"
furo = ">=2024.01.29"

[feature.docs.pypi-dependencies]
sphinx-autodoc-typehints = ">=1.25.0"
sphinx-copybutton = ">=0.5.2"
sphinx-design = ">=0.5.0"
readthedocs-sphinx-search = ">=0.3.0"
myst-nb = ">=1.1.0"  # Jupyter notebook support with MyST

[feature.docs.tasks]
docs-build = { cmd = "sphinx-build -b html docs/ docs/_build/html" }
docs-serve = { cmd = "python -m http.server 8000 --directory docs/_build/html" }
docs-clean = { cmd = "rm -rf docs/_build" }
docs-linkcheck = { cmd = "sphinx-build -b linkcheck docs/ docs/_build/linkcheck" }
docs-export = { cmd = "pixi project export conda-environment docs > environment.yml" }
docs = { depends-on = ["docs-clean", "docs-build"] }

[feature.bench.pypi-dependencies]
arcle = ">=0.2.6, <0.3"
