[project]
authors = ["Aadam <aadimator@gmail.com>"]
channels = ["conda-forge"]
name = "JaxARC"
platforms = ["osx-arm64", "linux-64"]
version = "0.1.0"

[tasks]

# Core system dependencies (conda-forge packages)
[dependencies]
python = ">=3.13.5,<3.14"

# Development and analysis tools (not needed for the package itself)
marimo = ">=0.13.6,<0.15"
wandb = ">=0.21.0,<0.22"
cairo = ">=1.18.4,<2"

[pypi-dependencies]
# Install the package itself in editable mode - this will pull all dependencies from pyproject.toml
JaxARC = { path = ".", editable = true }
# JAX ecosystem packages with platform-specific extras
jax = { version = ">=0.6.2, <0.7", extras = ["cuda12"] }

[activation.env]
JAX_PLATFORMS = "cuda,cpu"
# XLA_FLAGS = "--xla_gpu_autotune_level=0"
JAX_COMPILATION_CACHE_DIR="/tmp/jax_cache"
LD_LIBRARY_PATH = ""

[target.osx.pypi-dependencies]
jax = { extras = ["cpu"] }

[target.osx.activation.env]
JAX_PLATFORMS = "cpu"

[environments]
default = { solve-group = "default" }
dev = { features = ["dev"], solve-group = "default" }
docs = { features = ["docs"], solve-group = "default" }
test = { features = ["test"], solve-group = "default" }

[feature.test.dependencies]
pytest = ">=8.4.0,<9"
pytest-cov = ">=6.1.1,<7"
hypothesis = ">=6.100.0,<7"

[feature.test.tasks]
test = "pytest test/"

[feature.dev.dependencies]
pytest = ">=8.4.0,<9"
pytest-cov = ">=6.1.1,<7"
hypothesis = ">=6.100.0,<7"
pre-commit = ">=4.2.0,<5"
pylint = ">=3.3.7,<4"
jupyter = ">=1.1.1,<2"

[feature.dev.tasks]
lint = "pre-commit run --all-files"
pylint = "pylint jaxarc"

[feature.docs.tasks]
docs-init = { cmd = "jupyter book init --write-toc", cwd = "docs" }
docs-serve = { cmd = "jupyter book start --execute", cwd = "docs" }

[feature.docs.pypi-dependencies]
jupyter-book = ">=2.0.0a0"
